import{g as S,i as f,u as O,C as V,j as J,k as E,l as X,r as s,o as u,c as B,t as v,b as n,w as o,y as e,x as y,s as p,F as z,H as K,v as R,z as Q,A as b,am as Y,a5 as Z,D as ee}from"./vendor.d8bc4b48.js";import{g as te,B as $,u as ne,d as T,i as U,e as h}from"./main.90d606cc.js";import{L as ae}from"./LoadingIcon.73dcffb3.js";import{_ as oe}from"./InvoiceIndexDropdown.2607ca46.js";import{_ as re}from"./SendInvoiceModal.1fc085a2.js";import{_ as se}from"./RecurringInvoiceIndexDropdown.9c115e7b.js";const ie={class:"fixed top-0 left-0 hidden h-full pt-16 pb-4 ml-56 bg-white xl:ml-64 w-88 xl:block"},le={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},ce={class:"mb-6"},ue={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},de={class:"px-2 py-1 pb-2 mb-1 mb-2 text-sm border-b border-gray-200 border-solid"},me={key:0,class:"h-full pb-32 overflow-y-scroll border-l border-gray-200 border-solid base-scroll"},_e={class:"flex-2"},ge={class:"mt-1 mb-2 text-xs not-italic font-medium leading-5 text-gray-600"},pe={class:"flex-1 whitespace-nowrap right"},ve={class:"text-sm not-italic font-normal leading-5 text-right text-gray-600 est-date"},fe={class:"flex justify-center p-4 items-center"},ye={key:0,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},be={setup(D){te();const a=$();ne(),T(),U(),S(),f(null),f(null),f(null);const d=O();V(),f(["DRAFT","SENT","VIEWED","EXPIRED","ACCEPTED","REJECTED"]);const i=f(!1),m=f(!1),t=J({orderBy:null,orderByField:null,searchText:null}),x=E(()=>t.orderBy==="asc"||t.orderBy==null);function I(l){return d.params.id==l}async function _(){m.value=!0,await a.fetchRecurringInvoices(),m.value=!1,setTimeout(()=>{w()},500)}function w(){const l=document.getElementById(`recurring-invoice-${d.params.id}`);l&&(l.scrollIntoView({behavior:"smooth"}),l.classList.add("shake"))}async function g(){let l="";t.searchText!==""&&t.searchText!==null&&t.searchText!==void 0&&(l+=`search=${t.searchText}&`),t.orderBy!==null&&t.orderBy!==void 0&&(l+=`orderBy=${t.orderBy}&`),t.orderByField!==null&&t.orderByField!==void 0&&(l+=`orderByField=${t.orderByField}`),i.value=!0;let r=await a.searchRecurringInvoice(l);i.value=!1,r.data&&(a.recurringInvoices=r.data.data)}function C(){return t.orderBy==="asc"?(t.orderBy="desc",g(),!0):(t.orderBy="asc",g(),!0)}return _(),g=X.exports.debounce(g,500),(l,r)=>{const k=s("BaseIcon"),j=s("BaseInput"),F=s("BaseButton"),N=s("BaseRadio"),L=s("BaseInputGroup"),A=s("BaseDropdownItem"),P=s("BaseDropdown"),H=s("BaseText"),M=s("BaseRecurringInvoiceStatusBadge"),G=s("BaseFormatMoney"),q=s("router-link");return u(),B("div",ie,[v("div",le,[v("div",ce,[n(j,{modelValue:e(t).searchText,"onUpdate:modelValue":r[0]||(r[0]=c=>e(t).searchText=c),placeholder:l.$t("general.search"),type:"text",variant:"gray",onInput:r[1]||(r[1]=c=>g())},{right:o(()=>[n(k,{name:"SearchIcon",class:"h-5 text-gray-400"})]),_:1},8,["modelValue","placeholder"])]),v("div",ue,[n(P,{class:"ml-3",position:"bottom-start"},{activator:o(()=>[n(F,{size:"md",variant:"gray"},{default:o(()=>[n(k,{name:"FilterIcon",class:"h-5"})]),_:1})]),default:o(()=>[v("div",de,y(l.$t("general.sort_by")),1),n(A,{class:"flex px-1 py-2 cursor-pointer"},{default:o(()=>[n(L,{class:"-mt-3 font-normal"},{default:o(()=>[n(N,{id:"filter_next_invoice_date",modelValue:e(t).orderByField,"onUpdate:modelValue":[r[2]||(r[2]=c=>e(t).orderByField=c),g],label:l.$t("recurring_invoices.next_invoice_date"),size:"sm",name:"filter",value:"next_invoice_at"},null,8,["modelValue","label"])]),_:1})]),_:1}),n(A,{class:"flex px-1 py-2 cursor-pointer"},{default:o(()=>[n(L,{class:"-mt-3 font-normal"},{default:o(()=>[n(N,{id:"filter_start_date",modelValue:e(t).orderByField,"onUpdate:modelValue":[r[3]||(r[3]=c=>e(t).orderByField=c),g],label:l.$t("recurring_invoices.starts_at"),value:"starts_at",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),n(F,{class:"ml-1",size:"md",variant:"gray",onClick:C},{default:o(()=>[e(x)?(u(),p(k,{key:0,name:"SortAscendingIcon",class:"h-5"})):(u(),p(k,{key:1,name:"SortDescendingIcon",class:"h-5"}))]),_:1})])]),e(a)&&e(a).recurringInvoices?(u(),B("div",me,[(u(!0),B(z,null,K(e(a).recurringInvoices,(c,W)=>(u(),B("div",{key:W},[c&&!m.value?(u(),p(q,{key:0,id:"recurring-invoice-"+c.id,to:`/admin/recurring-invoices/${c.id}/view`,class:Q(["flex justify-between side-invoice p-4 cursor-pointer hover:bg-gray-100 items-center border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":I(c.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:o(()=>[v("div",_e,[n(H,{text:c.customer.name,length:30,class:"pr-2 mb-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),v("div",ge,y(c.invoice_number),1),n(M,{status:c.status,class:"px-1 text-xs"},{default:o(()=>[R(y(c.status),1)]),_:2},1032,["status"])]),v("div",pe,[n(G,{class:"block mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900",amount:c.total,currency:c.customer.currency},null,8,["amount","currency"]),v("div",ve,y(c.formatted_starts_at),1)])]),_:2},1032,["id","to","class"])):b("",!0)]))),128)),v("div",fe,[m.value?(u(),p(ae,{key:0,class:"h-6 m-1 animate-spin text-primary-400"})):b("",!0)]),!e(a).recurringInvoices.length&&!m.value?(u(),B("p",ye,y(l.$t("invoices.no_matching_invoices")),1)):b("",!0)])):b("",!0)])}}},Ie={class:"relative table-container"},Be={setup(D){const a=$(),d=f(null);f(null),Y("$utils");const{t:i}=S();f(null),V();const m=T(),t=E(()=>[{key:"invoice_date",label:i("invoices.date"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"invoice_number",label:i("invoices.invoice")},{key:"customer.name",label:i("invoices.customer")},{key:"status",label:i("invoices.status")},{key:"total",label:i("invoices.total")},{key:"actions",label:i("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);function x(){return m.hasAbilities([h.DELETE_INVOICE,h.EDIT_INVOICE,h.VIEW_INVOICE,h.SEND_INVOICE])}return(I,_)=>{const w=s("router-link"),g=s("BaseFormatMoney"),C=s("BaseInvoiceStatusBadge"),l=s("BaseTable");return u(),B(z,null,[n(re),v("div",Ie,[n(l,{ref_key:"table",ref:d,data:e(a).newRecurringInvoice.invoices,columns:e(t),loading:e(a).isFetchingViewData,"placeholder-count":5,class:"mt-5"},Z({"cell-invoice_number":o(({row:r})=>[n(w,{to:{path:`/admin/invoices/${r.data.id}/view`},class:"font-medium text-primary-500"},{default:o(()=>[R(y(r.data.invoice_number),1)]),_:2},1032,["to"])]),"cell-total":o(({row:r})=>[n(g,{amount:r.data.due_amount,currency:r.data.currency},null,8,["amount","currency"])]),"cell-status":o(({row:r})=>[n(C,{status:r.data.status,class:"px-3 py-1"},{default:o(()=>[R(y(r.data.status),1)]),_:2},1032,["status"])]),_:2},[x()?{name:"cell-actions",fn:o(({row:r})=>[n(oe,{row:r.data,table:d.value},null,8,["row","table"])])}:void 0]),1032,["data","columns","loading"])])],64)}}},he={setup(D){const a=$(),d=O();let i=E(()=>a.isFetchingViewData);ee(d,()=>{d.params.id&&d.name==="recurring-invoices.view"&&m()},{immediate:!0});async function m(){await a.fetchRecurringInvoice(d.params.id)}return(t,x)=>{const I=s("BaseHeading"),_=s("BaseDescriptionListItem"),w=s("BaseDescriptionList"),g=s("BaseCard");return u(),p(g,{class:"mt-10"},{default:o(()=>[n(I,null,{default:o(()=>[R(y(t.$t("customers.basic_info")),1)]),_:1}),n(w,{class:"mt-5"},{default:o(()=>[n(_,{label:t.$t("recurring_invoices.starts_at"),"content-loading":e(i),value:e(a).newRecurringInvoice?.formatted_starts_at},null,8,["label","content-loading","value"]),n(_,{label:t.$t("recurring_invoices.next_invoice_date"),"content-loading":e(i),value:e(a).newRecurringInvoice?.formatted_next_invoice_at},null,8,["label","content-loading","value"]),e(a).newRecurringInvoice?.limit_date&&e(a).newRecurringInvoice?.limit_by!=="NONE"?(u(),p(_,{key:0,label:t.$t("recurring_invoices.limit_date"),"content-loading":e(i),value:e(a).newRecurringInvoice?.limit_date},null,8,["label","content-loading","value"])):b("",!0),e(a).newRecurringInvoice?.limit_date&&e(a).newRecurringInvoice?.limit_by!=="NONE"?(u(),p(_,{key:1,label:t.$t("recurring_invoices.limit_by"),"content-loading":e(i),value:e(a).newRecurringInvoice?.limit_by},null,8,["label","content-loading","value"])):b("",!0),e(a).newRecurringInvoice?.limit_count?(u(),p(_,{key:2,label:t.$t("recurring_invoices.limit_count"),value:e(a).newRecurringInvoice?.limit_count,"content-loading":e(i)},null,8,["label","value","content-loading"])):b("",!0),e(a).newRecurringInvoice?.selectedFrequency?(u(),p(_,{key:3,label:t.$t("recurring_invoices.frequency.title"),value:e(a).newRecurringInvoice?.selectedFrequency?.label,"content-loading":e(i)},null,8,["label","value","content-loading"])):b("",!0)]),_:1}),n(I,{class:"mt-8"},{default:o(()=>[R(y(t.$t("invoices.title",2)),1)]),_:1}),n(Be)]),_:1})}}},De={setup(D){U();const a=$(),d=T();S(),V();const i=E(()=>a.newRecurringInvoice?a.newRecurringInvoice?.customer?.name:"");function m(){return d.hasAbilities([h.DELETE_RECURRING_INVOICE,h.EDIT_RECURRING_INVOICE])}return(t,x)=>{const I=s("BasePageHeader"),_=s("BasePage");return u(),p(_,{class:"xl:pl-96"},{default:o(()=>[n(I,{title:e(i)},{actions:o(()=>[m()?(u(),p(se,{key:0,row:e(a).newRecurringInvoice},null,8,["row"])):b("",!0)]),_:1},8,["title"]),n(be),n(he)]),_:1})}}};export{De as default};

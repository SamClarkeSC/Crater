import{g as z,i as $,j as M,k as v,D,m as g,n as p,q as F,r as u,o as U,c as G,b as o,w as c,y as e,z as N,v as E,x as P,t as j,a0 as O,B as T}from"./vendor.d8bc4b48.js";import{c as Y,m as Z}from"./main.90d606cc.js";const R=["onSubmit"],A={class:"divide-y divide-gray-200"},Q={setup(H){const b=Y(),i=Z(),{t:m,tm:J}=z();let f=$(!1),s=$(!1);const r=M({...b.selectedCompanySettings});v(()=>i.config.retrospective_edits.map(t=>(t.title=m(t.key),t))),D(()=>r.carbon_date_format,t=>{if(t){const n=i.dateFormats.find(d=>d.carbon_format_value===t);r.moment_date_format=n.moment_format_value}});const y=v({get:()=>r.discount_per_item==="YES",set:async t=>{const n=t?"YES":"NO";let d={settings:{discount_per_item:n}};r.discount_per_item=n,await b.updateCompanySettings({data:d,message:"general.setting_updated"})}}),B=v(()=>({currency:{required:g.withMessage(m("validation.required"),p)},language:{required:g.withMessage(m("validation.required"),p)},carbon_date_format:{required:g.withMessage(m("validation.required"),p)},moment_date_format:{required:g.withMessage(m("validation.required"),p)},time_zone:{required:g.withMessage(m("validation.required"),p)},fiscal_year:{required:g.withMessage(m("validation.required"),p)}})),a=F(B,v(()=>r));V();async function V(){s.value=!0,Promise.all([i.fetchCurrencies(),i.fetchDateFormats(),i.fetchTimeZones()]).then(([t])=>{s.value=!1})}async function S(){a.value.$touch(),!a.value.$invalid&&(f.value=!0,await b.updateCompanySettings({data:{settings:{...r}},message:"settings.preferences.updated_message"}),f.value=!1)}return(t,n)=>{const d=u("BaseMultiselect"),_=u("BaseInputGroup"),q=u("BaseInputGrid"),w=u("BaseIcon"),h=u("BaseButton"),k=u("BaseDivider"),I=u("BaseSwitchSection"),C=u("BaseSettingCard");return U(),G("form",{action:"",class:"relative",onSubmit:T(S,["prevent"])},[o(C,{title:t.$t("settings.menu_title.preferences"),description:t.$t("settings.preferences.general_settings")},{default:c(()=>[o(q,{class:"mt-5"},{default:c(()=>[o(_,{"content-loading":e(s),label:t.$tc("settings.preferences.currency"),"help-text":t.$t("settings.preferences.company_currency_unchangeable"),error:e(a).currency.$error&&e(a).currency.$errors[0].$message,required:""},{default:c(()=>[o(d,{modelValue:e(r).currency,"onUpdate:modelValue":n[0]||(n[0]=l=>e(r).currency=l),"content-loading":e(s),options:e(i).currencies,label:"name","value-prop":"id",searchable:!0,"track-by":"name",invalid:e(a).currency.$error,disabled:"",class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["content-loading","label","help-text","error"]),o(_,{label:t.$tc("settings.preferences.default_language"),"content-loading":e(s),error:e(a).language.$error&&e(a).language.$errors[0].$message,required:""},{default:c(()=>[o(d,{modelValue:e(r).language,"onUpdate:modelValue":n[1]||(n[1]=l=>e(r).language=l),"content-loading":e(s),options:e(i).config.languages,label:"name","value-prop":"code",class:"w-full","track-by":"code",searchable:!0,invalid:e(a).language.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),o(_,{label:t.$tc("settings.preferences.time_zone"),"content-loading":e(s),error:e(a).time_zone.$error&&e(a).time_zone.$errors[0].$message,required:""},{default:c(()=>[o(d,{modelValue:e(r).time_zone,"onUpdate:modelValue":n[2]||(n[2]=l=>e(r).time_zone=l),"content-loading":e(s),options:e(i).timeZones,label:"key","value-prop":"value","track-by":"key",searchable:!0,invalid:e(a).time_zone.$error},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),o(_,{label:t.$tc("settings.preferences.date_format"),"content-loading":e(s),error:e(a).carbon_date_format.$error&&e(a).carbon_date_format.$errors[0].$message,required:""},{default:c(()=>[o(d,{modelValue:e(r).carbon_date_format,"onUpdate:modelValue":n[3]||(n[3]=l=>e(r).carbon_date_format=l),"content-loading":e(s),options:e(i).dateFormats,label:"display_date","value-prop":"carbon_format_value","track-by":"carbon_format_value",searchable:"",invalid:e(a).carbon_date_format.$error,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["label","content-loading","error"]),o(_,{"content-loading":e(s),error:e(a).fiscal_year.$error&&e(a).fiscal_year.$errors[0].$message,label:t.$tc("settings.preferences.fiscal_year"),required:""},{default:c(()=>[o(d,{modelValue:e(r).fiscal_year,"onUpdate:modelValue":n[4]||(n[4]=l=>e(r).fiscal_year=l),"content-loading":e(s),options:e(i).config.fiscal_years,label:"key","value-prop":"value",invalid:e(a).fiscal_year.$error,"track-by":"key",searchable:!0,class:"w-full"},null,8,["modelValue","content-loading","options","invalid"])]),_:1},8,["content-loading","error","label"])]),_:1}),o(h,{"content-loading":e(s),disabled:e(f),loading:e(f),type:"submit",class:"mt-6"},{left:c(l=>[o(w,{name:"SaveIcon",class:N(l.class)},null,8,["class"])]),default:c(()=>[E(" "+P(t.$tc("settings.company_info.save")),1)]),_:1},8,["content-loading","disabled","loading"]),o(k,{class:"mt-6 mb-2"}),j("ul",A,[o(I,{modelValue:e(y),"onUpdate:modelValue":n[5]||(n[5]=l=>O(y)?y.value=l:null),title:t.$t("settings.preferences.discount_per_item"),description:t.$t("settings.preferences.discount_setting_description")},null,8,["modelValue","title","description"])])]),_:1},8,["title","description"])],40,R)}}};export{Q as default};
